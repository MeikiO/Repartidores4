<!DOCTYPE HTML>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="/aaa_layouts/clientes/layout_cliente">

<head> 
    <title>Nuevo pedido</title> 
        <link rel="stylesheet" type="text/css" href="#" th:href="@{/css/retoques.css}">
</head>
	
<body>

    <p th:text="'EL CLIENTE se queja desde esta ventana'" />
    
    <header layout:fragment="header">
    	<p> Por si falla el nav </p>
    </header>
    
       
   <section layout:fragment="custom-content" class="document__content">

		<h1 class="text-center">Registro de Pedido</h1>
	
		<form method="post" action="#" th:action="@{/cliente/procesarLinea}" th:object="${linea_pedido}" autocomplete="off">
		    <div class="form-group">
	       		<input hidden type="text" th:field="*{id}" />
	       		<input hidden type="text" th:field="*{producto}"/>
		    </div>
		      
		    <div class="form-group">
			  	<label for="producto">Producto</label>
			      
			    <select name="producto_formulario">
		      		<option value="default">Selecciona Producto</option>
		    		<option th:each="producto: ${listaProductos}" 
		    		th:value="${producto.nombre}"
		    		th:text="${producto.nombre}"/>
		        </select>   
		  	</div>
			  
				<!-- Link para hacer el contador chulo (manda a la siguiente ventana) 
					https://stackoverflow.com/questions/54398234/style-input-type-number-more-plus-button-on-the-side
				-->

			<div class="form-group">
			 	<label for="candidad">Cantidad: </label>
				<!-- How to get correctly the input values 
					https://stackoverflow.com/questions/40899494/how-to-get-input-values-from-spring-boot-thyme-leaf-to-java-class
				 -->    
			  <input min="0"  name="quantity" value="1" th:field="*{candidad}" type="number">
			</div>
		
		
			<button type="submit" class="btn btn-primary" name="action"  value="anadir_producto">Poner producto en pedido</button>
		
		</form>
		
<!-- __________________________________________ -->
		<div class="retoque-tabla">
			 <table class="table table-hover">
				   <thead>
                        <tr>
                            <td>Nombre Producto</td>
                            <td>Cantidad</td>
                            <td>Precio base</td>
                            <td>Descuento</td>
                            <td></td>
                        </tr>
                    </thead>
                    <tbody>
                   		<tr th:each="linea : ${pedido.listaLineas}">
                   		 <form action="#" th:action="@{'/cliente/eliminarLinea/' + ${linea.id}}" method="post">
	                                <td th:text="${linea.producto.nombre}"></td> 
	                                <td th:text="${linea.candidad}"></td> 
	                                <td th:text="${linea.producto.precio_producto}"></td> 
	                                <td th:text="${linea.producto.descuento}"></td> 
                                <td>
                                	<button type="submit" name="action" value="borrar" class="btn btn-danger">-</button>
                                </td>
	                    	</form>
	                      </tr>
                    </tbody>
                </table>
		</div>


<!-- ____________________________ -->


		    <div>
                <label>Precio Total: </label>
                <input class="form-control z-depth-1" id="precio" type="text" th:value="${pedido.precio_total}" readonly="readonly">
            </div>
		
		
					
			<form method="post" action="#" th:action="@{/cliente/terminarPedido}"  autocomplete="off">
				<!-- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/textarea -->
				<div class="form-group shadow-textarea">
				 	<label for="observaciones">Observaciones: </label>
	
					<textarea id="observaciones" class="form-control z-depth-1"
					          rows="5" cols="33" name="observaciones">
					</textarea>
				</div>	  
				 	
			   	<button type="submit" class="btn btn-primary " name="action"  value="hacer_pedido">Hacer Pedido</button>
			</form>	
		
	
	</section>
	
</body>
</html>